import{L as h}from"./Logo-mPGmAf0v.js";import{A as d,a as l,D as m,S as c}from"./TestimonyTranscription-uyMVVO1v.js";class u{constructor(t,e){this.cardWidth=t,this.numColumns=e,this.createRootDiv(),this.createLogoDiv(),this.createLinksDiv(),this.createSearchLink(),this.createHr(),this.createSubtitle()}createRootDiv(){this.rootDiv=document.createElement("div"),document.body.appendChild(this.rootDiv),this.numColumns>1&&(this.rootDiv.style.display="grid",this.rootDiv.style.gridTemplateColumns=`repeat(${this.numColumns}, ${100/this.numColumns}%)`)}createLogoDiv(){this.logoDiv=document.createElement("div");let t=new h(`${this.cardWidth}px`);this.logoDiv.append(t.img),this.rootDiv.append(this.logoDiv)}createLinksDiv(){let t=document.createElement("div");t.style.display="grid",t.style.gridTemplateRows="50% 50%",this.linksDiv=document.createElement("div"),this.linksDiv.style.gridRowStart="2",this.linksDiv.style.display="flex",this.linksDiv.style.flexDirection="column",this.linksDiv.style.justifyContent="flex-end",this.linksDiv.style.maxHeight=this.logoDiv.offsetHeight/2,t.append(this.linksDiv),this.rootDiv.append(t)}createSearchLink(){let t=document.createElement("a");t.href="/search.html",t.style.fontSize="20px",t.style.margin="5px";let e=document.createElement("i");e.className="fa fa-search",e.style.marginRight="10px",t.append(e),t.append("Search jail testimonies by topic"),this.linksDiv.append(t)}createHr(){this.hr=document.createElement("hr"),document.body.append(this.hr)}createSubtitle(){let t=document.createElement("h3");t.append("These interviews and letters are accounts of the lives impacted by the Cook County Jail in Chicago, IL."),document.body.append(t)}}class r{constructor(t,e,i=t.id,n=TestimonyTranscription){this.testimonyMetadata=t,this.date=new Date(t.date),this.width=e,this.titleText=i,this.transcriptionType=n,this.margin=5,this.borderWidth=2,this.adjustedWidth=this.width-(this.margin+this.borderWidth)*2,this.createRootDiv(),this.createTitle(),this.createTranscription()}createRootDiv(){this.rootDiv=document.createElement("div"),this.rootDiv.style.padding="5px",this.rootDiv.style.margin=`${this.margin}px`,this.rootDiv.style.border=`${this.borderWidth}px solid black`,this.rootDiv.style.width=`${this.adjustedWidth}px`,this.rootDiv.style.backgroundColor="#dddddd"}createTitle(){this.title=document.createElement("p"),this.title.style.fontWeight="bold",this.rootDiv.append(this.title),this.title.innerText=this.titleText}createTranscription(){this.transcription=new this.transcriptionType(this.testimonyMetadata,this.toolBar),this.rootDiv.append(this.transcription.rootDiv)}}class p extends r{constructor(t,e=400){const i=new Date(t.date);super(t,e,`Recorded ${i.toLocaleString("default",{month:"long"})}, ${i.getUTCFullYear()}`,d),this.createAudioPlayer()}createAudioPlayer(){this.audioPlayer=new l(this.testimonyMetadata.id),this.rootDiv.append(this.audioPlayer.audio)}}class v extends r{constructor(t,e=400){const i=new Date(t.date);super(t,e,`Received ${i.toLocaleString("default",{month:"long"})}, ${i.getUTCFullYear()}`,m),this.insertPreviewImage()}insertPreviewImage(){this.previewImage=document.createElement("img"),this.previewImage.src=`/testimonies/${this.testimonyMetadata.id}.png`,this.previewImage.style.width=`${this.adjustedWidth}px`,this.title.after(this.previewImage)}}class y{constructor(t,e){this.cardWidth=t,this.numColumns=e,this.createRootDiv(),this.createSpinner(),this.fetchTestimoniesManifest().then(i=>{this.testimonies=i,this.shuffleTestimonies(),this.createTestimonyCards(),this.awaitImagesLoaded().then(n=>{this.removeSpinner(),this.createColumnDivs(),this.divvyCardsIntoColumns()})})}createRootDiv(){this.rootDiv=document.createElement("div"),document.body.append(this.rootDiv)}createSpinner(){this.spinner=new c(150,15),this.rootDiv.append(this.spinner.div)}removeSpinner(){this.spinner.div.remove()}fetchTestimoniesManifest(){return fetch("manifest.json").then(t=>t.json()).then(t=>t.testimonies)}shuffleTestimonies(){for(let t=this.testimonies.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.testimonies[t],this.testimonies[e]]=[this.testimonies[e],this.testimonies[t]]}}createTestimonyCards(){this.testimonyCards=[];for(let t of this.testimonies)t.type==="audio"?this.testimonyCards.push(new p(t,this.cardWidth)):t.type==="document"&&this.testimonyCards.push(new v(t,this.cardWidth))}createColumnDivs(){this.rootDiv.style.display="grid",this.rootDiv.style.gridTemplateColumns=`repeat(${this.numColumns}, ${100/this.numColumns}%)`,this.columnDivs=new Array(this.numColumns).fill(0).map(t=>{let e=document.createElement("div");return this.rootDiv.append(e),e})}awaitImagesLoaded(){return Promise.all(this.testimonyCards.filter(t=>t.type==="document").map(t=>new Promise((e,i)=>{t.previewImage.addEventListener("load",e)})))}divvyCardsIntoColumns(){let t=this.columnDivs.map(e=>0);for(let e=0;e<this.testimonyCards.length;e++){const i=t.indexOf(Math.min(...t));this.columnDivs[i].append(this.testimonyCards[e].rootDiv),t[i]+=this.testimonyCards[e].rootDiv.offsetHeight}}}document.documentElement.style.scrollBehavior="smooth";document.body.style.backgroundColor="#b0b0ab";document.body.style.fontFamily="Arial, Helvetica, sans-serif";document.body.style.boxSizing="border-box";const o=window.innerWidth<=1e3?window.innerWidth-40:500,a=Math.floor(window.innerWidth/o);new u(o,a);new y(o,a);
