import{L as c}from"./Logo-PUBKW1pz.js";class m{constructor(t,e){this.cardWidth=t,this.numColumns=e,this.createRootDiv(),this.createLogoDiv(),this.createLinksDiv(),this.createSearchLink(),this.createHr(),this.createSubtitle()}createRootDiv(){this.rootDiv=document.createElement("div"),document.body.appendChild(this.rootDiv),this.numColumns>1&&(this.rootDiv.style.display="grid",this.rootDiv.style.gridTemplateColumns=`repeat(${this.numColumns}, ${100/this.numColumns}%)`)}createLogoDiv(){this.logoDiv=document.createElement("div");let t=new c(this.cardWidth);this.logoDiv.append(t.img),this.rootDiv.append(this.logoDiv)}createLinksDiv(){let t=document.createElement("div");t.style.display="grid",t.style.gridTemplateRows="50% 50%",this.linksDiv=document.createElement("div"),this.linksDiv.style.gridRowStart="2",this.linksDiv.style.display="flex",this.linksDiv.style.flexDirection="column",this.linksDiv.style.maxHeight=this.logoDiv.offsetHeight/2,t.append(this.linksDiv),this.rootDiv.append(t)}createSearchLink(){let t=document.createElement("a");t.href="/search.html",t.style.fontSize="20px";let e=document.createElement("i");e.className="fa fa-search",e.style.marginRight="10px",t.append(e),t.append("Search jail testimonies by topic"),this.linksDiv.append(t)}createHr(){this.hr=document.createElement("hr"),document.body.append(this.hr)}createSubtitle(){let t=document.createElement("h3");t.append("These interviews and letters are accounts of the lives impacted by the Cook County Jail in Chicago, IL."),document.body.append(t)}}class p{constructor(t=25,e=3,i="#000000",s="#ffffff",d=1){this.div=document.createElement("div"),this.div.className="spinner";let o=this.div.style;o.border=`${e}px solid ${s}`,o.borderRadius="50%",o.borderTop=`${e}px solid ${i}`,o.height=`${t}px`,o.width=`${t}px`,o.animation=`spin ${d}s linear infinite`}}let u=class{constructor(t){this.name=t,this.fetchTranscription(),this.createRootDiv(),this.createAndRenderSpinner(),this.transcription.then(e=>{this.transcription=e,this.removeSpinner(),this.createTextDiv(),this.organizeTranscriptionInTextDiv()})}createRootDiv(){this.rootDiv=document.createElement("div")}fetchTranscription(){this.transcription=fetch(`/testimonies/${this.name}.txt`).then(t=>t.text()).then(t=>t.split(`

`))}createAndRenderSpinner(){this.spinner=new p,this.rootDiv.append(this.spinner.div)}removeSpinner(){this.spinner.div.remove()}createTextDiv(){this.textDiv=document.createElement("div"),this.textDiv.style.marginBottom="5px",this.textDiv.style.transition="max-height 0.02s",this.textDiv.style.scrollBehavior="smooth",this.rootDiv.append(this.textDiv)}organizeTranscriptionInTextDiv(){this.textDiv.append(this.transcription.toString())}};class a extends u{constructor(t){super(t),this.expanded=!1,this.transcription.then(e=>{this.transcription=e,this.createToolBar(),this.createMoreButton(),this.createLink()})}createToolBar(){this.toolBar=document.createElement("div"),this.toolBar.style.display="flex",this.toolBar.style.justifyContent="space-between",this.rootDiv.append(this.toolBar)}expandText(){this.expanded=!0,this.textDiv.style.maxHeight=`${window.innerHeight-200}px`,this.textDiv.style.overflow="scroll",this.moreButton.innerText="Show less text",setTimeout(()=>window.scroll(0,this.rootDiv.offsetTop-100),40)}collapseText(){this.expanded=!1,this.textDiv.style.maxHeight="200px",this.textDiv.style.overflow="hidden",this.textDiv.scroll(0,0),this.moreButton.innerText="Show more text"}toggleText(){this.expanded?this.collapseText():this.expandText()}createMoreButton(){this.moreButton=document.createElement("button"),this.moreButton.style.marginBottom="5px",this.moreButton.onclick=()=>this.toggleText(),this.toolBar.appendChild(this.moreButton),this.collapseText()}createLink(){let t=document.createElement("a");t.href=`/audio.html?id=${this.name}`,t.append("Open account in a new page"),this.toolBar.append(t)}}class v extends a{constructor(t){super(t)}organizeTranscriptionInTextDiv(){for(let t of this.transcription){let[e,i]=t.split(`
`),s=document.createElement("p");s.id=e,s.append(i),s.style.margin="0px",s.style.textIndent="25px",this.textDiv.append(s)}}}class y extends a{constructor(t){super(t)}organizeTranscriptionInTextDiv(){for(let t of this.transcription){if(t.length===0)continue;let e=document.createElement("p");e.append(t),e.style.margin="0px",e.style.textIndent="25px",this.textDiv.append(e)}}}class h{constructor(t,e,i=t.name,s=TestimonyTranscription){this.name=t.name,this.type=t.type,this.date=new Date(t.date),this.width=e,this.titleText=i,this.transcriptionType=s,this.margin=5,this.borderWidth=2,this.adjustedWidth=this.width-(this.margin+this.borderWidth)*2,this.createRootDiv(),this.createTitle(),this.createTranscription()}createRootDiv(){this.rootDiv=document.createElement("div"),this.rootDiv.style.padding="5px",this.rootDiv.style.margin=`${this.margin}px`,this.rootDiv.style.border=`${this.borderWidth}px solid black`,this.rootDiv.style.width=`${this.adjustedWidth}px`,this.rootDiv.style.backgroundColor="#dddddd"}createTitle(){this.title=document.createElement("p"),this.title.style.fontWeight="bold",this.rootDiv.append(this.title),this.title.innerText=this.titleText}createTranscription(){this.transcription=new this.transcriptionType(this.name,this.toolBar),this.rootDiv.append(this.transcription.rootDiv)}}class D extends h{constructor(t,e=400){const i=new Date(t.date);super(t,e,`Recorded ${i.toLocaleString("default",{month:"long"})}, ${i.getUTCFullYear()}`,v),this.createAudioPlayer()}createAudioPlayer(){this.audio=document.createElement("audio"),this.audio.controls=!0,this.audio.style.width="100%";let t=document.createElement("source");t.src=`testimonies/${this.name}.mp3`,t.type="audio/mpeg",this.audio.appendChild(t),this.rootDiv.append(this.audio)}}class x extends h{constructor(t,e=400){const i=new Date(t.date);super(t,e,`Received ${i.toLocaleString("default",{month:"long"})}, ${i.getUTCFullYear()}`,y),this.insertPreviewImage()}insertPreviewImage(){this.previewImage=document.createElement("img"),this.previewImage.src=`/testimonies/${this.name}.png`,this.previewImage.style.width=`${this.adjustedWidth}px`,this.title.after(this.previewImage)}}class g{constructor(t,e){this.cardWidth=t,this.numColumns=e,this.fetchTestimoniesManifest().then(i=>{this.testimonies=i,this.createRootDiv(),this.shuffleTestimonies(),this.createTestimonyCards(),this.createColumnDivs(),this.awaitImagesLoaded().then(s=>{this.divvyCardsIntoColumns()})})}fetchTestimoniesManifest(){return fetch("manifest.json").then(t=>t.json()).then(t=>t.testimonies)}createRootDiv(){this.rootDiv=document.createElement("div"),document.body.append(this.rootDiv)}shuffleTestimonies(){for(let t=this.testimonies.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.testimonies[t],this.testimonies[e]]=[this.testimonies[e],this.testimonies[t]]}}createTestimonyCards(){this.testimonyCards=[];for(let t of this.testimonies)t.type==="audio"?this.testimonyCards.push(new D(t,this.cardWidth)):t.type==="document"&&this.testimonyCards.push(new x(t,this.cardWidth))}createColumnDivs(){this.rootDiv.style.display="grid",this.rootDiv.style.gridTemplateColumns=`repeat(${this.numColumns}, ${100/this.numColumns}%)`,this.columnDivs=new Array(this.numColumns).fill(0).map(t=>{let e=document.createElement("div");return this.rootDiv.append(e),e})}awaitImagesLoaded(){return Promise.all(this.testimonyCards.filter(t=>t.type==="document").map(t=>new Promise((e,i)=>{t.previewImage.addEventListener("load",e)})))}divvyCardsIntoColumns(){let t=this.columnDivs.map(e=>0);for(let e=0;e<this.testimonyCards.length;e++){const i=t.indexOf(Math.min(...t));this.columnDivs[i].append(this.testimonyCards[e].rootDiv),t[i]+=this.testimonyCards[e].rootDiv.offsetHeight}}}document.documentElement.style.scrollBehavior="smooth";document.body.style.backgroundColor="#b0b0ab";document.body.style.fontFamily="Arial, Helvetica, sans-serif";document.body.style.boxSizing="border-box";const r=window.innerWidth<=1e3?window.innerWidth:500,l=Math.floor(window.innerWidth/r);new m(r,l);new g(r,l);
